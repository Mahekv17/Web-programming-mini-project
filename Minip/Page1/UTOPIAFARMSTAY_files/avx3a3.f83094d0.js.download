(this.$WP=this.$WP||[]).push(["avx3a3",(e,t)=>{var a,r,s,i,n,o,l,c,u,d,p,m,h,g,f,v,S,y,D,I,b,N,T,E,_,w,L,A,O,k,C,x,q,G,P,R,j,H,U={seeAllLinks:!1,titles:!1,tagTranslations:!1,maxAccommodations:!1,tooltips:!1},W=()=>U,M=(e,t)=>{var a=new Date;a.setDate(a.getDate()+e),t.push(a.getFullYear()),t.push(a.getMonth()+1),t.push(a.getDate())},$=(e,t,a)=>{var r=t.travelerInfo&&t.travelerInfo.hotels;if(r)e.stayDates=r.stayDates,e.guests=r.guests,e.paramSeqId=r.paramSeqId||0;else{var s=[];M(1,s),M(2,s),e.stayDates=s.join("_"),e.guests="1_1",e.paramSeqId=0}e.requestNumber>1&&(e.searchKey=t?.page?.crossSells?.endpointResults?.searchKey),a.sponsoredListingsEnabled&&(1===e.requestNumber?e.sponsoredListingData={}:e.sponsoredListingData=t?.page?.crossSells?.endpointResults?.sponsoredListingData||{}),t.tracking&&t.tracking.uid&&(e.pageLoadUid=t.tracking.uid)},F=(e,t)=>{var a={detailId:t.featuredAccommodation,requestNumber:e.page.crossSells.requestNumber,configuration:t.configuration,requestCaller:t.requestCaller,filters:t.filters};return $(a,e,t),a},z=(e,t)=>{var a=new URLSearchParams;if(a.append("rn",String(e.requestNumber)),a.append("stayDates",e.stayDates),a.append("guestInfo",e.guests),a.append("csc",e.configuration),a.append("rc",e.requestCaller),e.sponsoredListingData){var r={...e.sponsoredListingData};delete r.debugData,a.append("sld",JSON.stringify(r))}return e.requestNumber>t.length&&a.append("ifp",""),e.searchKey&&a.append("sk",e.searchKey),e.pageLoadUid&&a.append("puid",e.pageLoadUid),e.paramSeqId&&a.append("paramSeqId",String(e.paramSeqId)),e.filters&&a.append("ft",JSON.stringify(e.filters)),`/data/1.0/crosssellaccommodations/${e.detailId}?${a.toString()}`},K=e=>{var{accommodationsByType:t,pageLocations:a,isSearchComplete:r,sponsoredListingData:s,searchKey:i}=e;return{pageLocations:a,locationMap:a.reduce((e,a)=>(e[a.locationName]={crossSells:a.crossSellTypes.map(e=>t[e]),locationName:a.locationName,locationOrder:a.locationOrder},e),{}),isSearchComplete:r,sponsoredListingData:s,searchKey:i}},J=(e,t,a)=>{var r=`/data/1.0/crosssellaccommodations/${e}/uiAssets/${t}`,s=new URLSearchParams;a&&s.append("ft",JSON.stringify(a));var i=s.toString();return i?`${r}?${i}`:r},B=e=>{window.__SP_DEBUG_EVENTS__=window.__SP_DEBUG_EVENTS__||[],e.forEach(e=>window.__SP_DEBUG_EVENTS__.push(e)),window.require("ta/Core/TA.FireEvent").fireEvent("sp_debug_refresh")};function X(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var V="hr_xsell_skeleton";function Y(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Q=[10,1e3,1e3,1e3,1e3,1500,1500,1500,2e3,2e3,2e3],Z="Will stop polling.",ee=e=>!!e.detailId&&!!e.stayDates&&!!e.guests,et=(e,t=1e4)=>Promise.race([fetch(e,{method:"GET",header:{"Content-Type":"application/json"},credentials:"same-origin"}),new Promise((e,a)=>{setTimeout(()=>a(Error("timeout")),t)})]);function ea(e,t){if(t.length<e)throw TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function er(e){ea(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):(("string"==typeof e||"[object String]"===t)&&"undefined"!=typeof console&&Error().stack,new Date(NaN))}function es(e,t){for(var a=Math.abs(e).toString();a.length<t;)a="0"+a;return(e<0?"-":"")+a}function ei(e,t){if(arguments.length<1)throw TypeError("1 argument required, but only ".concat(arguments.length," present"));var a=er(e);if(!function(e){return ea(1,arguments),!isNaN(er(e))}(a))throw RangeError("Invalid time value");var r=t||{},s=null==r.format?"extended":String(r.format),i=null==r.representation?"complete":String(r.representation);if("extended"!==s&&"basic"!==s)throw RangeError("format must be 'extended' or 'basic'");if("date"!==i&&"time"!==i&&"complete"!==i)throw RangeError("representation must be 'date', 'time', or 'complete'");var n="",o="",l="extended"===s?"-":"";if("time"!==i){var c=es(a.getDate(),2),u=es(a.getMonth()+1,2),d=es(a.getFullYear(),4);n="".concat(d).concat(l).concat(u).concat(l).concat(c)}if("date"!==i){var p=a.getTimezoneOffset();if(0!==p){var m=Math.abs(p),h=es(Math.floor(m/60),2),g=es(m%60,2);o="".concat(p<0?"+":"-").concat(h,":").concat(g)}else o="Z";var f=es(a.getHours(),2),v=es(a.getMinutes(),2),S=es(a.getSeconds(),2),y=""===n?"":"T",D=[f,v,S].join("extended"===s?":":"");n="".concat(n).concat(y).concat(D).concat(o)}return n}var en=e=>"cg"===e,eo=e=>{for(var t={},a=function(a){Object.keys(e[a]).forEach(r=>{t[`${r}`]=e[a][r]})},r=0;r<e.length;r++)a(r);return t},el=e=>e&&e.reduce((e,t)=>(e[t.key]=t.value,e),{}),ec=(e,t)=>{if(!en(t))return null;var a=e.comparisonGridInfo&&e.comparisonGridInfo.nearbyTransportation&&{name:e.comparisonGridInfo.nearbyTransportation?.location?.name||"",distance:Number(e.comparisonGridInfo.nearbyTransportation?.distance?.toFixed(1))||0,type:e.comparisonGridInfo.nearbyTransportation?.poiType||"flights"}||null,r=e.comparisonGridInfo&&{name:e.comparisonGridInfo.nearbyHighlightPoi?.location?.name||"",distance:Number(e.comparisonGridInfo.nearbyHighlightPoi?.distance?.toFixed(1))||0,type:e.comparisonGridInfo.nearbyHighlightPoi?.poiType||"parking"}||null,s=e.comparisonGridInfo&&r&&a&&{name:e.comparisonGridInfo.location?.neighborhoods?.[0]?.name||e.location?.geoName||"",nearbyTransportation:a,nearbyPOI:r}||null,i=e.comparisonGridInfo?.availableAmenityKeys?.map(e=>e&&e.tagId||0)||[],n=e.comparisonGridInfo?.reviewSnippets?.items?.filter(e=>e).map(e=>{var t=e&&e.text||"";return{htmlEscapedText:t=(t=t.replaceAll("￹",'<span class="highlighted">')).replaceAll("￻","</span>"),url:e&&e.reviewUrl?.url||""}})||null;return e.comparisonGridInfo&&n&&i&&s&&{availableAmenityKeys:i,accommodationClassTagId:e.comparisonGridInfo.location?.detail?.starRating?.[0]?.tagId,neighborhood:s,reviewSnippets:n}||null},eu=(e,t,a)=>{var r,s=e.location?.reviewSummary?.rating||0;s&&(s*=10);var i=e.location&&{latitude:e.location.latitude,longitude:e.location.longitude},n={id:e.location?.locationId||0,name:e.location?.name||"",detailUrl:e.location?.url||"",numReviews:e.location?.reviewSummary?.count||0,bubbleRating:s,geoPoint:i,thumbnail:e.location?.thumbnail},o=ec(e,t),l=e.sponsoredListingInfo?{tracking_guid:e.sponsoredListingInfo.trackingGUID,attributionToken:e.sponsoredListingInfo.attributionToken?e.sponsoredListingInfo.attributionToken:void 0}:void 0;e.distance?.distance&&e.distance?.unit&&(r={distance:e.distance.distance,unit:e.distance.unit});var c={location:n,listingKey:e.listingKey||"",displayPrice:e.displayPrice||"",distance:r,localizedDistance:e.localizedDistance||"",sponsoredListingV2:l,hideSPPill:a,popIndexMessage:e.popIndexMessage||""};return en(t)&&o&&(c.comparisonGridInfo=o),c},ed=(e,t)=>{var{accommodationsByType:a,pageLocations:r,isHacComplete:s,searchKey:i}=e||{},n=el(a),o=s?y.SHOWING:y.LOADING;return{pageLocations:r,locationMap:r&&r.reduce((e,t)=>{var a=[];return t.crossSellTypes.forEach(e=>{var t={};en(e)&&(t=eo(n[e].accommodations.map(e=>e&&e.comparisonGridInfo.availableAmenityKeys?.map(e=>{var t={};return e&&e.tagId&&(t[e.tagId]=e.localizedName),t})).flat())),a.push({accommodations:n[e].accommodations.map(t=>t&&eu(t,e,n[e].hideSponsoredPill)),crossSellType:n[e].crossSellType,placementName:n[e].placementName,isOverallComplete:s,impressionKey:"",tagTranslations:t,updateWithNewData:!0,displayState:o})}),e[t.locationName]={crossSells:a,locationName:t.locationName,locationOrder:t.locationOrder},e},{}),isSearchComplete:t,sponsoredListingData:void 0,searchKey:i}},ep=e=>{var{seeAllLinks:t,tagTranslations:a,titles:r,tooltips:s}=e||{},i=el(t),n={};return Object.keys(i||{}).forEach(e=>{i[e]&&(n[e]=i[e].nonCanonicalUrl)}),{seeAllLinks:n,tagTranslations:el(a),titles:el(r),tooltips:el(s),maxAccommodations:!1}},em={__key:0x7499fe1d807c,id:"7499fe1d807c7151",loc:{},definitions:[]},eh=[1e3,1e3,1e3,1e3,1500,1500,1500,2e3,2e3,2e3,5e3,1e4],eg=()=>m("meta_absolute_pricing")?"ALL_IN_FULL_STAY":m("meta_all_in_pricing")?"ALL_IN_RATE":"BASE_RATE";function ef(e){var[,t]=r(0),a=s(null),n=s(null),o=s(0),l=s(0),{updateCrossSellEndpointData:c,filters:u}=e,{page:d,params:p}=h(),m=g(),{detailId:f=-1}=p,{hotels:v}=N(),S=E(),y=b(),D=eg(),T=n.current,w={adults:v&&v.adults||2,rooms:v&&v.rooms||1,checkInDate:v?.checkInDate?ei(v.checkInDate,{representation:"date"}):"",checkOutDate:v?.checkOutDate?ei(v.checkOutDate,{representation:"date"}):"",childAgesPerRoom:v&&v.childAgesPerRoom,usedDefaultDates:v&&!!v.defaultDates},L=u&&u.zft&&parseInt(u.zft,10),A=null;L&&(A={integerFilters:[{filterType:"MULTI_TAG",values:[L]}]});var O={locationId:f,application:"HOTEL_DETAIL",currencyCode:S,pricingMode:D,sessionId:y,pageviewUid:m,travelInfo:w,requestNumber:l.current,filters:A,route:{page:d,params:p}};n.current=O,I(T&&T.travelInfo,O.travelInfo)||(l.current=0,o.current=0);var[{fetching:k,data:C,error:x}]=_({query:em,variables:O}),q=C&&C.HPS_getWebXSellShelves,G=(({data:e,error:t})=>e?.HPS_getWebXSellShelves?.isHacComplete||!!t)({data:C,error:x})||l.current>=eh.length,P=ed(q,G),R=!k&&!G&&P,j=!k&&!x&&P&&o.current<=l.current;return i(()=>{j&&(R&&(clearTimeout(a.current),a.current=setTimeout(()=>{l.current+=1,t(e=>e+1)},eh[l.current])),o.current+=1,c(P))},[l,R,j,o,P,c]),null}var ev={__key:0xc84f6b4b3b08,id:"c84f6b4b3b08fade",loc:{},definitions:[]};function eS(e){var{containerLoadedCallback:t,setUIAssets:a,application:r}=e,[{fetching:s,data:n,error:o}]=_({query:ev,variables:{locationId:e.featuredAccommodation,application:r}}),l=ep(n&&n.HPS_getWebXSellComponents);return i(()=>{!l||o||s||(t(),a(l))},[s,o,l,a,t]),null}var ey=(e,t,a,r)=>{e&&fetch(J(e,t,r),{method:"GET",header:{"Content-Type":"application/json"},credentials:"same-origin"}).then(e=>{if(e.ok)return e;throw JSON.stringify(e),Error(e.statusText)}).then(e=>e.json()).then(e=>{a(e)})};function eD(e){var t="locationPhotoDirectLink"===e.requestCaller,[a,s]=r(!1),n=m("t4b_hr_xsell_sponsored_slot_0_display")&&!t,{didALocationRegister:o,featuredAccommodation:l,xsellConfig:p,setUIAssets:g,filters:f,requestCaller:v,skipOnLoadSearch:S}=e,{page:y}=h(),D="Hotel_Review"===y;i(()=>{D||a||!o||(ey(l,p,g,f),s(!0))},[a,s,o,l,p,g,f,D]);var I=null;if(!a&&o&&D&&(I=c(j,{featuredAccommodation:l,application:"HOTEL_DETAIL",containerLoadedCallback:()=>(s(!0),null)})),o&&a){var b={configuration:p,featuredAccommodation:l,requestCaller:v||"hotelReview",sponsoredListingsEnabled:n,serverSideSponsoredHotelSelectionEnabled:n,skipOnLoadSearch:S,filters:f};I=D?u(d,{children:[I,c(R,{...b})]}):c(P,{...b})}return I}var eI={seeAllLinks:!1,titles:!1,tagTranslations:!1,maxAccommodations:!1,tooltips:!1},eb=()=>{if("undefined"==typeof window)return W();var e=l().getState();return e?.page?.crossSells?.uiAssets||eI},eN=(e,t,a)=>t&&e&&t[e]?t[e]:a,eT=e=>eN(e,H().titles,c(T,{id:"p13n_you_may_also_like"})),eE=e=>{var{tooltips:t}=H();return t&&e&&t[e]||null},e_=(e,t,a)=>t&&e&&t[e]?t[e]:a,ew=e=>{var{seeAllLinks:t}=H();return e_(e,t,t?.default)};return[()=>{w=class extends a{render(){return null}constructor(e){super(e),U=e.data}},O=n({data:(e,t)=>{var a=t("/data/1.0/crosssellaccommodations/comparisongridcrosssellsuiassets/");return()=>{var{data:e,loading:t}=a.get();return t||!e?{}:{data:e}}},actions:{}})(w),L=class extends a{render(){return null}constructor(e){super(e),this.props.updateCrossSellEndpointData(this.props.data)}},k=n({data:(e,t)=>{var a=t("/data/1.0/crosssellaccommodations/comparisongridcrosssells");return e=>{var{data:t,loading:r}=a.get();return r||!t||e.page.crossSells.updatingResults?{}:{data:K(t)}}},actions:{updateCrossSellEndpointData:o.page.hotelreview.setCrossSellsEndpointResults}})(L),C={module:V,action:"xsell_show"},x={module:V,action:"xsell_collapse"},q={module:V,action:"xsell_remains_hidden"},G=class{constructor(e=D){X(this,"trackEventAjax",void 0),X(this,"displayStates",void 0),X(this,"previousResults",void 0),X(this,"shouldShowIncompleteResults",void 0),X(this,"calculateDisplayStates",(e,t,a=!1)=>{for(var{accommodationsByType:r,...s}=e,i={},n=Object.keys(r),o=0;o<n.length;o++){var l=n[o],c=r[l],u=!1;this.displayStates[l]||(this.displayStates[l]=y.HIDDEN,u=!0);var d=this.displayStates[l],p=c.accommodations.length>0,m=c.isOverallComplete,h=void 0;if(a){var g=this.shouldShowIncompleteResults[l];h=this.getTimeoutStateTransition(d,m,g)}else h=this.getNextDisplayStateTransition(d,p,m,t,u);h.updateWithNewData&&(this.displayStates[l]=h.displayState),i[l]={...c,...h}}var f={accommodationsByType:i,...s};return this.previousResults=f,f}),X(this,"calculateTimeoutStates",()=>this.calculateDisplayStates(this.previousResults,0,!0)),X(this,"transition",(e,t)=>({displayState:e,updateWithNewData:t})),X(this,"fromHidden",(e,t,a)=>e?(this.trackEventAjax(C),this.transition(y.SHOWING,!0)):t?(a&&this.trackEventAjax(q),this.transition(y.HIDDEN,!1)):(this.trackEventAjax(C),this.transition(y.LOADING,!0))),X(this,"fromLoading",(e,t)=>e?this.transition(y.SHOWING,!0):t?(this.trackEventAjax(x),this.transition(y.HIDDEN,!0)):this.transition(y.LOADING,!1)),X(this,"fromShowing",(e,t,a)=>e?this.transition(y.SHOWING,!0):t?(this.trackEventAjax(x),this.transition(y.HIDDEN,!0)):1===a?this.transition(y.LOADING,!0):this.transition(y.SHOWING,!1)),X(this,"getNextDisplayStateTransition",(e,t,a,r,s)=>{switch(e){case y.HIDDEN:return this.fromHidden(t,a,s);case y.LOADING:return this.fromLoading(t,a);default:return this.fromShowing(t,a,r)}}),X(this,"getTimeoutStateTransition",(e,t,a=!0)=>{if(e===y.SHOWING){if(t||a)return this.transition(y.SHOWING,!1)}else e===y.LOADING&&this.trackEventAjax(x);return this.transition(y.HIDDEN,e!==y.HIDDEN)}),this.trackEventAjax=e,this.displayStates={},this.shouldShowIncompleteResults={n:!0,c:!0,m:!0}}},A=class extends a{componentDidMount(){this.props.skipOnLoadSearch||this.fetchCrossSellData()}componentDidUpdate(e){this.urlParamsChanged(e.urlData)&&!this.props.updatingXSellResults&&this.fetchCrossSellData()}urlParamsChanged(e){var t=this.props.urlData;return e.requestNumber!==t.requestNumber||e.stayDates!==t.stayDates||e.guests!==t.guests||e.detailId!==t.detailId||e.configuration!==t.configuration||e.requestCaller!==t.requestCaller||!f(e.filters,t.filters)}fetchCrossSellData(){var{urlData:e}=this.props;if(!ee(e)){JSON.stringify(e);return}et(z(e,this.pollingDelay)).then(e=>{if(e.ok||e.status>=200&&e.status<300)return e;var t=`ResponseStatus: ${e.status} Invalid results from server: ${JSON.stringify(e)}`;return 400===e.status&&(t=`${Z} ${t}`),Promise.reject(Error(t))}).then(e=>e.json()).then(e=>{var t=this.displayManager.calculateDisplayStates(e,this.props.urlData.requestNumber);t.sponsoredListingData&&t.sponsoredListingData.debugData&&B(t.sponsoredListingData.debugData);var a=K(t);this.props.updateCrossSellEndpointData(a),a.isSearchComplete||this.triggerPoll()}).catch(e=>{e?.message?.startsWith(Z)||this.triggerPoll()})}triggerPoll(){var e={poll:this.props.poll,pollingDelay:this.pollingDelay,requestNumber:this.props.urlData.requestNumber,loading:!1,complete:!1,timedOut:this.pollingTimedOut};JSON.stringify(e),v(e,this.timerContainer)}render(){return null}constructor(e){super(e),Y(this,"displayManager",void 0),Y(this,"pollingDelay",void 0),Y(this,"pollingTimedOut",()=>{this.props.urlData.requestNumber;var e=K(this.displayManager.calculateTimeoutStates());this.props.updateCrossSellEndpointData(e)}),Y(this,"timerContainer",new S),this.displayManager=new G,this.pollingDelay=Q}},P=p((e,t)=>({...t,urlData:F(e,t),updatingXSellResults:!!e.page.crossSells?.updatingResults}),{poll:o.page.hotelreview.crossSellsPoll,updateCrossSellEndpointData:o.page.hotelreview.setCrossSellsEndpointResults})(A),R=p((e,t)=>({...t}),{updateCrossSellEndpointData:o.page.hotelreview.setCrossSellsEndpointResults})(ef),j=p((e,t)=>({...t}),{setUIAssets:o.page.hotelreview.setUIAssets})(eS),e({ComparisonGridDataLoader:k,UiAssetLoader:O,WaitForPageLocation:p((e,t)=>({...t,didALocationRegister:!t.wait&&!!e.page.crossSells?.atLeastOneLocationRegistered,featuredAccommodation:Number(e.route.detail||e.page.detailId)}),{setUIAssets:o.page.hotelreview.setUIAssets})(eD),getSeeAllUrlForCrossSellType:ew,getTitleForCrossSellType:eT,getTooltipForCrossSellType:eE,getUIAssets:H=eb})},[e=>(a=e.Component,r=e.useState,s=e.useRef,i=e.useEffect),e=>n=e.bind,e=>(o=e.actions,l=e.getStore),e=>(c=e.jsx,u=e.jsxs,d=e.Fragment),e=>p=e.connect,e=>m=e.featureIsEnabled,e=>(h=e.useRoute,g=e.usePageviewUid),e=>f=e.default,e=>(v=e.setTimer,S=e.TimerContainer),e=>y=e.DisplayState,e=>D=e.default,e=>I=e.shallowEquals,e=>b=e.useSessionId,e=>N=e.useTravelInfo,e=>(T=e.default,E=e.useCurrency),e=>_=e.useQuery]]},["o4yt4q","6z5q2p","45ddp0","21h32l","2mj4nv","skjzuv","fgwvq1","b5nukb","0l1dx6","o1fcvi","4axon3","t05m6z","al4vil","etaac9","7thqz4","mqwhqn"]]);
