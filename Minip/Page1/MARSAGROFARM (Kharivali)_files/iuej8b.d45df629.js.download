(this.$WP=this.$WP||[]).push(["iuej8b",(e,r)=>{var t,n,i,a,o,l,s,c,d,u,m,p,g,h,f,v,y,w,b,k,D,C,S,R,T,_,x,I,N,O,P,B,U,L,E,F,A,j,q,M,z,H,K,X,G,Y,$,W,Z,V,J,Q,ee,er,et,en,ei,ea,eo,el,es,ec={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},ed=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,eu=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,em=/^([+-])(\d{2})(?::?(\d{2}))?$/;function ep(e,r){!function(e,r){if(r.length<e)throw TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+r.length+" present")}(1,arguments);var t,n,i=r||{},a=null==i.additionalDigits?2:function(e){if(null===e||!0===e||!1===e)return NaN;var r=Number(e);return isNaN(r)?r:r<0?Math.ceil(r):Math.floor(r)}(i.additionalDigits);if(2!==a&&1!==a&&0!==a)throw RangeError("additionalDigits must be 0, 1 or 2");if(!("string"==typeof e||"[object String]"===Object.prototype.toString.call(e)))return new Date(NaN);var o=function(e){var r,t={},n=e.split(ec.dateTimeDelimiter);if(n.length>2)return t;if(/:/.test(n[0])?(t.date=null,r=n[0]):(t.date=n[0],r=n[1],ec.timeZoneDelimiter.test(t.date)&&(t.date=e.split(ec.timeZoneDelimiter)[0],r=e.substr(t.date.length,e.length))),r){var i=ec.timezone.exec(r);i?(t.time=r.replace(i[1],""),t.timezone=i[1]):t.time=r}return t}(e);if(o.date){var l=function(e,r){var t=RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+r)+"})|(\\d{2}|[+-]\\d{"+(2+r)+"})$)"),n=e.match(t);if(!n)return{year:null};var i=n[1]&&parseInt(n[1]),a=n[2]&&parseInt(n[2]);return{year:null==a?i:100*a,restDateString:e.slice((n[1]||n[2]).length)}}(o.date,a);t=function(e,r){if(null===r)return null;var t,n,i=e.match(ed);if(!i)return null;var a=!!i[4],o=eg(i[1]),l=eg(i[2])-1,s=eg(i[3]),c=eg(i[4]),d=eg(i[5])-1;if(a)return c>=1&&c<=53&&d>=0&&d<=6?((t=new Date(0)).setUTCFullYear(r,0,4),n=t.getUTCDay()||7,t.setUTCDate(t.getUTCDate()+((c-1)*7+d+1-n)),t):new Date(NaN);var u=new Date(0);return l>=0&&l<=11&&s>=1&&s<=(ef[l]||(ev(r)?29:28))&&o>=1&&o<=(ev(r)?366:365)?(u.setUTCFullYear(r,l,Math.max(o,s)),u):new Date(NaN)}(l.restDateString,l.year)}if(isNaN(t)||!t)return new Date(NaN);var s=t.getTime(),c=0;if(o.time&&(isNaN(c=function(e){var r=e.match(eu);if(!r)return null;var t=eh(r[1]),n=eh(r[2]),i=eh(r[3]);return(24===t?0===n&&0===i:i>=0&&i<60&&n>=0&&n<60&&t>=0&&t<25)?36e5*t+6e4*n+1e3*i:NaN}(o.time))||null===c))return new Date(NaN);if(o.timezone){if(isNaN(n=function(e){if("Z"===e)return 0;var r=e.match(em);if(!r)return 0;var t="+"===r[1]?-1:1,n=parseInt(r[2]),i=r[3]&&parseInt(r[3])||0;return i>=0&&i<=59?t*(36e5*n+6e4*i):NaN}(o.timezone)))return new Date(NaN)}else{var d=new Date(s+c),u=new Date(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate(),d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds());return u.setFullYear(d.getUTCFullYear()),u}return new Date(s+c+n)}function eg(e){return e?parseInt(e):1}function eh(e){return e&&parseFloat(e.replace(",","."))||0}var ef=[31,null,31,30,31,30,31,31,30,31,30,31];function ev(e){return e%400==0||e%4==0&&e%100}var ey=()=>{var{localize:e}=O();return t(T,{padding:"spacing-03",children:[t(T,{display:"flex",flexDirection:"column",alignItems:"center",marginTop:"spacing-04",marginBottom:"spacing-06",children:[n(P,{variant:"supporting-02",children:e.string("plus_roomlist_skeleton_support")}),n($,{})]}),ee,ee,ee,ee]})},ew={__key:0xdd9620b27b64,id:"dd9620b27b64a26c",loc:{},definitions:[]},eb={headerContainer:"Hnbqz f k",headerContainerRedesign:"TJsdi",headerContainerCoBranding:"yNImk",title:"yrRAp",leftBorder:"Tftqk"},ek=({coBrandingLogoUrl:e,isRoomGridRedesignEnabled:r})=>t("div",{className:u(eb.headerContainer,{[eb.headerContainerRedesign]:r,[eb.headerContainerCoBranding]:!!e}),children:[n(T,{display:"flex",className:eb.title,children:n(P,{variant:"title-02",children:n(N,{id:"hr_ib_offer_select_your_room"})})}),t(T,{display:"flex",flexDirection:"row",alignItems:"center",children:[n(T,{display:"flex",marginRight:"spacing-02",alignItems:"center",marginBottom:r?"spacing-03":"spacing-00",children:n(W,{variant:"plus-logo-short",height:e?23:28})}),e&&t(T,{display:"flex",flexDirection:"row",alignItems:"center",children:[n("div",{className:eb.leftBorder,children:n(P,{variant:"supporting-02",marginX:"spacing-01",children:"in partnership with"})}),n(Z,{src:`https:${e}`,height:30})]})]})]}),eD=({checkInDate:e,checkOutDate:r,numAdults:i,numChildren:a,numRooms:o,openPicker:l})=>t(T,{paddingX:"spacing-03",paddingTop:"spacing-03",children:[t(T,{display:"flex",justifyContent:"space-between",flexDirection:["column","row-reverse","row-reverse"],paddingX:["spacing-00","spacing-02","spacing-02"],marginBottom:"spacing-04",children:[n(V,{width:176}),n(T,{display:"flex",paddingTop:["spacing-03","spacing-00","spacing-00"],children:n(P,{variant:"title-02",children:n(N,{id:"hr_ib_offer_select_your_room"})})})]}),t(T,{display:"flex",flexDirection:["column","row","row"],paddingX:["spacing-00","spacing-02","spacing-02"],children:[n(P,{variant:"body-01",marginRight:"spacing-02",children:n(N,{id:"hr_ib_offer_best_prices_for"})}),t(T,{display:"flex",flexDirection:"row",children:[n(K,{checkInDate:e,checkOutDate:r,numberOfRooms:o,numberOfAdults:i,numberOfChildren:a}),n(L,{marginLeft:"spacing-04",onClick:l,children:n(N,{id:"hr_ib_offer_edit"})})]})]})]}),eC=({perks:e,cashbackDisplayAmount:r})=>{var{localize:i}=O(),[a,l]=o(!1);return r||e&&e.length>0?n(T,{className:"znZCg Ra d",marginTop:"spacing-03",children:t(P,{variant:"title-05",children:[i.string("plus_roomlist_callout_good_upgrade"),"\xa0",n("button",{className:"YkSFV B- Cg _S d",onClick:()=>l(!0),children:n(J,{})}),a&&n(Q,{variant:"steps",onClose:()=>l(!1),perks:e,cashbackDisplayAmount:r,showCloseButton:!1})]})}):null},eS=({optimusPerks:e,variant:r="PARTIAL"})=>{var{localize:a}=O();return t(i,{children:[t(T,{display:"flex",flexDirection:"row",alignItems:"flex-start",paddingX:"spacing-04",paddingTop:"spacing-04",children:[n(P,{variant:"title-02",children:a.string("plus_roomlist_select_your_room")}),n("div",{className:"HLzBW F2 Wi",children:n(W,{variant:"plus-logo-short"})})]}),n(T,{display:"flex",flexDirection:"column",alignItems:"flex-start",paddingX:"spacing-04",children:n(P,{variant:"supporting-01",marginY:"spacing-02",children:a.string("plus_roomlist_support")})}),"FULL"===r&&n(T,{paddingX:"spacing-04",children:n(ei,{perks:e})})]})},eR="plus_red_room_list_on_/hr_v2_1624295048",eT="room-grid-ready",e_=()=>n(er,{}),ex=(e,r)=>(!r&&e?.OptimusRoomCatalog_getRooms[0]?.rooms||[]).map(e=>({key:e.key,shortDescription:e.shortDescription,longDescription:e.longDescription,photos:e.photos})),eI=(e,r)=>{if(e){var t=e.getBoundingClientRect().top+window.pageYOffset-r;window.scrollTo({top:t,behavior:"smooth"})}},eN=({checkInDate:e,checkOutDate:r,coBrandingLogoUrl:a,hasCashback:o,isIbBranded:l,isRoomGridRedesign:s,numAdults:c,numChildren:d,numRooms:u,openPicker:m,optimusPerks:p})=>l?n(en,{checkInDate:e,checkOutDate:r,numAdults:c,numChildren:d,numRooms:u,openPicker:m}):o||s?t(i,{children:[n(et,{coBrandingLogoUrl:a,isRoomGridRedesignEnabled:s}),t(T,{paddingX:"spacing-04",display:"flex",flexDirection:["column","row","row"],children:[n(P,{variant:"body-01",marginRight:"spacing-02",children:n(N,{id:"hr_ib_offer_best_prices_for"})}),t(T,{display:"flex",flexDirection:"row",children:[n(K,{checkInDate:e,checkOutDate:r,numberOfRooms:u,numberOfAdults:c,numberOfChildren:d}),n(L,{marginLeft:"spacing-04",onClick:m,children:n(N,{id:"hr_ib_offer_edit"})})]})]})]}):n(ea,{variant:"FULL",optimusPerks:p}),eO=({bookingSessionId:e,offerData:r,partnerData:o=[],roomSelectionSummary:l,roomSelectionData:s,bookingAdditionalContext:d,optimusSavings:u,optimusSubscriptionPrice:y,refreshRooms:R,onSelectRoom:T,showPriceMismatchError:_,onPriceMismatchErrorShown:I,parentFunnelKey:N,funnelKey:O,isCashback:P,hasError:B,setFullStoryCustomAttributes:U,logFullStoryEvent:L})=>{var E={...s.polling,...s?.trackingContext?{trackingContext:s.trackingContext}:{}},[F,{partnerData:j,roomSelectionData:q},M]=w({...s,polling:E},o,P),z=F?j:o,H=F?q:s;b(l,R);var K=k(z||[],u,d.originalMetaPrice),{filterBlockedRooms:X}=D(),Y=X(K,l,H?.partnerInfos[0]?.commerce?.providerId),[$,W]=a.useState(!1);c(()=>{var e=setTimeout(()=>W(!0),36e5);return()=>clearTimeout(e)},[]);var Z=A(),{page:V}=p(),J=g(),Q=m(),ee=h(),er=x(),{plusRoomGridRedesign:et,fetching:en}=G();c(()=>{U({isSubscriber:y?.isMember||!1,isVF:P});var e={numberOfRooms:Y.length,providerOfOffer:H?.partnerInfos[0]?.displayName||"",funnelKey:O||""};L("PlusEvent",e),er&&Z({itemType:"optimusCheckoutStep",itemId:"RoomSelection",itemName:"FULL_STORY",team:"Plus",impressionKey:O||"",pageUid:J,sessionId:Q,userId:ee,page:V,customData:JSON.stringify(e)})},[y,P,Y,H,U,L,O,er,Z,V,Q,ee,J]);var ei=!!M||B,ea=d.originalMetaPrice>0,eo=C(z,d),es=(z||[])[0]?.name,ec=H.partnersOptimusPerks[es||""]||[],ed=(z||[])[0]?.hotel?.locationId,eu=(z||[])[0]?.coBrandingLogoUrl;if(!F||en)return n(e_,{});if(ei)return n(f,{variant:"inline",onClick:()=>{!Y.length||M?(window.location.reload(),window.scrollTo(0,0)):I()}});var em=new Date(ep(H.summary.checkInDs)),eg=new Date(ep(H.summary.checkOutDs)),eh=r?.optimusBranding==="IB";return t(i,{children:[n(eN,{checkInDate:em,checkOutDate:eg,coBrandingLogoUrl:eu,hasCashback:!!u?.cashback,isIbBranded:eh,isRoomGridRedesign:et,numRooms:H.summary.rooms,numAdults:H.summary.adults,numChildren:H.summary.totalChildren,openPicker:()=>{el.emit("open")},optimusPerks:ec}),ea&&"same"!==eo&&_&&!$&&!ei&&n(v,{}),M?null:n(S,{bookingSessionId:e,rooms:Y||[],flow:"HOTEL",onSelectRoom:T,offerData:r,alwaysStretchShowAllButton:!1,allowCollapse:!0,locationId:ed,parentImpressionKey:N||void 0,isCashback:P,optimusPerks:ec,isRoomGridRedesign:et})]})},eP=({offerData:e,guests:r,locationId:i})=>{var[o,d]=a.useState(0),[u,f]=a.useState(!1),[v,w]=a.useState(null),[b,k]=a.useState(null),[D,C]=a.useState(!1),S=m(),T=h(),x=l(null),{page:N}=p(),O=g(),P=a.useRef(null),B=a.useRef(null),L=U({experimentKeys:[eR]}),[E,M]=a.useState(!1),z=null!==L&&"test"===L[eR],K=A(),G=X(),Y=s((e,r,t)=>{G({itemType:"optimusCheckoutPurchaseError",itemName:e,impressionKey:P.current||"",customData:{flow:"HOTEL",reasonType:t||"Unknown",errorDetail:r}})},[P,G]),$=s(e=>{Y(e?e.map(({name:e})=>e).join("|"):"MISSING_DATA",e?e.map(({message:e})=>e).join("|"):"",e?e.map(({type:e})=>e).join("|"):"Unknown")},[Y]);c(()=>{(o||u)&&eI(x.current,96)},[o,u]),c(()=>(b?(eo.emit(eT,!1),eo.reply(eT,()=>!1)):(eo.emit(eT,!0),eo.reply(eT,()=>!0)),()=>{eo.emit(eT,!1),eo.reply(eT,()=>!1)}),[b,e]),c(()=>{b&&(Y(b),C(!0))},[b,Y]),c(()=>{var e=e=>{B.current=e,o&&x.current?eI(x.current,96):d(e=>e+1)};return eo.on("expand-rooms",e),()=>{eo.off("expand-rooms",e)}},[o]);var W=e&&e.clickToken||"",Z=()=>{d(e=>e+1)},V=()=>{Z()};c(()=>{if(!W){w(null);return}window.require(["trjs!commerce/offerclick"],e=>{var r=e.expandToken(W);P.current=r.ik;var t=null;try{var[,n]=(r.url||"").split("?");t=new URLSearchParams(n)}catch(e){w(null);return}if(!t||!o){w(null);return}if(f(!0),1===o){K({itemType:"optimusCheckoutStep",itemId:"RoomSelection",itemName:"ROOMLIST",team:"Plus",impressionKey:P.current||"",pageUid:O,sessionId:S,userId:T,page:N,customData:JSON.stringify({flow:"HOTEL",booking_flow:"allowed"})});var i=new AbortController,a=setTimeout(()=>i.abort(),3e3);t.set("puid",encodeURIComponent(O)),fetch("/StartBooking",{method:"POST",credentials:"same-origin",body:t.toString(),headers:{"content-type":"application/x-www-form-urlencoded"},signal:i.signal}).finally(()=>clearTimeout(a))}t.delete("puid"),t.delete("src"),t.append("sar","true"),fetch(`/data/1.0/booking/rooms?${t.toString()}`,{method:"GET",credentials:"same-origin",headers:{"Content-Type":"application/json"}}).then(e=>e.ok?e.json():(k("REQUEST_FAILURE"),null)).then(w).finally(()=>f(!1))})},[T,S,N,o,W,K,O]);var J=H(r),[{data:Q,fetching:ee}]=q({query:ew,variables:{locationId:i||0,numRooms:J?.rooms||0,numAdults:J?.adults||0,numChildren:J?.children||0,providerId:e?.provider||""},pause:!e?.provider||!e?.isOptimusOffer||!T||!z}),er=ex(Q,ee);return!o&&er.length&&T&&z&&e?.optimusBookingFlow==="ALLOWED"?n(F,{funnelKey:P.current,children:t(es,{ref:x,children:[n(ea,{variant:"PARTIAL"}),n(R,{partialRooms:er,flow:"HOTEL",onSelectShowPrice:()=>d(e=>e+1),locationId:i||0})]})}):e?.isOptimusOffer&&(ee||o)?n(_,{children:n(I.Consumer,{children:({setCustomAttributes:r,logEvent:t})=>n(F,{funnelKey:P.current,children:n(y,{data:v,loading:u,error:b,children:({bookingData:i,errors:a,loading:o})=>{if(o||ee)return n(es,{ref:x,children:n(e_,{})});var{bookingSessionId:l,partnerData:s,roomSelectionSummary:c,roomSelectionData:d,bookingAdditionalContext:u,optimusSavings:m,optimusSubscriptionPrice:p,isCashback:g}=i||{};return!d||a?n(j,{onVisible:()=>{eo.emit(eT,!1),$(a)},children:e=>n("div",{ref:e})}):n(es,{ref:x,children:n(eO,{bookingSessionId:l,offerData:e,partnerData:s||[],roomSelectionSummary:c,roomSelectionData:d,bookingAdditionalContext:u,optimusSavings:m,optimusSubscriptionPrice:p,refreshRooms:Z,onSelectRoom:V,showPriceMismatchError:!E,onPriceMismatchErrorShown:()=>M(!0),parentFunnelKey:B.current,funnelKey:P.current,isCashback:g,hasError:D,setFullStoryCustomAttributes:r,logFullStoryEvent:t})})}})})})}):null};return[()=>{ee=t(T,{display:"flex",flexDirection:"row",alignItems:"flex-start",justifyContent:"flex-start",children:[n("div",{className:"EXXqb Wh",children:n(Y,{height:"100%",width:"100%"})}),t("div",{className:"vljsv F2",children:[n(Y,{height:21,width:"50%"}),n(Y,{height:21,width:"80%",marginTop:12}),n(Y,{height:21,width:"65%",marginTop:12})]})]}),er=ey,et=ek,en=eD,ei=eC,ea=eS,eo=B("optimus/room-list"),el=B("h-drg"),es=d(function({children:e},r){var a=l(null),{enabled:o}=z();return t(i,{children:[n(T,{backgroundColor:"primaryBackground",marginBottom:"spacing-04",ref:r,className:u({"B1 Z BB":o}),children:e}),n(E,{callback:()=>{a.current&&(a.current.getBoundingClientRect().bottom<0?eo.emit("sticky-top-bar-enable"):eo.emit("sticky-top-bar-disable"))}})]})}),e("default",M(e=>({guests:e.travelerInfo.hotels?.guests||""}))(eP))},[e=>(t=e.jsxs,n=e.jsx,i=e.Fragment),e=>(a=e,o=e.useState,l=e.useRef,s=e.useCallback,c=e.useEffect,d=e.forwardRef),e=>u=e.default,e=>m=e.useSessionId,e=>(p=e.useRoute,g=e.usePageviewUid),e=>h=e.useUserId,e=>(f=e.RoomUnavailableAlert,v=e.PriceMismatchAlert),e=>(y=e.HotelCheckoutParsedDataSupplier,w=e.useRoomSelectionPolling,b=e.useRefreshRooms,k=e.useRoomsWithPatchedSavings,D=e.useBlockedRooms),e=>C=e.usePriceMismatchCheck,e=>(S=e.default,R=e.PartialRoomGrid),e=>T=e.Box,e=>(_=e.PlusFullStoryProvider,x=e.useFullStoryEnabled),e=>I=e.BaseFullStoryContext,e=>(N=e.default,O=e.useLocalize),e=>P=e.default,e=>B=e.createRadio,e=>U=e.default,e=>L=e.BorderlessButton,e=>E=e.default,e=>F=e.FunnelTrackingProvider,e=>A=e.default,e=>j=e.HasBeenVisible,e=>q=e.useQuery,e=>M=e.connect,e=>z=e.useHRExpandedCommerce,e=>H=e.parseGuestInfo,e=>K=e.default,e=>X=e.useOptimusImpression,e=>G=e.useRoomGridRedesignEnabled,e=>Y=e.default,e=>$=e.OllieSpinner,e=>W=e.default,e=>(Z=e.OptimusPartnerLogo,V=e.TripadvisorLogo),e=>J=e.default,e=>Q=e.default]]},["21h32l","o4yt4q","fkji80","al4vil","fgwvq1","52far5","sfmsly","vk3cpw","4lbe82","vmz0vp","lyyh8d","79sk7i","4cu0tk","7thqz4","essqvy","bqgabj","gugp1d","jppfwt","w1vb4i","kkqcv8","xg719z","w0dpwq","mqwhqn","2mj4nv","wsk8ra","bxkng5","jllnoc","yc73mo","7g0c7c","u59av4","qndsds","sw5ax0","bovo24","zq967r","bnv3wx"]]);
