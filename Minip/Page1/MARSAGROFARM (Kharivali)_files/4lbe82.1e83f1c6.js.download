(this.$WP=this.$WP||[]).push(["4lbe82",(e,t)=>{var r,n,o,a,s,l=["//","while(true);","while(1);","for(;;);"],i=e=>{if("string"!=typeof e)throw Error("Unable to parse JSON response");for(var t=0;t<l.length;t++){var r=l[t];if(0===e.indexOf(r))return JSON.parse(e.substring(r.length))}return JSON.parse(e)};function u(e,t,r){var n=r?`&${new URLSearchParams(r).toString()}`:"";return n=n.concat("&flowOrigin=optimus"),fetch(`/HotelBookingController?flowState=${e}${n}`,{method:"POST",body:JSON.stringify(t),credentials:"same-origin",headers:{"Content-Type":"application/json"}}).then(t=>{if(t.ok)return t.text();throw Error(`Unable to fetch booking data for flow state: ${e}`)}).then(e=>i(e)).catch(t=>{throw Error(t||`Error while fetching data for flow state: ${e}`)})}function f(e){var t;u("BOOK",(t={...e,transactionId:r()},["partnerInfos","paymentCountryConfig","phoneCountryConfig","billingInformation","metaOffers","hotelPhotos"].forEach(e=>delete t[e]),t)).then(e=>console.debug("Booking submitted, res:",e))}function c(){var e=s(),[t,a]=n([]),[l,i]=n(null),[f,c]=n(!0),h=e=>{var t=e?.storedCardInfo?.billingAddressInfo?.addressInfo;return t?.country&&t?.street&&t?.city&&t?.state&&t?.postalCode};return o(()=>{u("GET_CARDS",void 0,{requestId:r()}).then(e=>{a((e||[]).filter(e=>h(e))),i(null)}).catch(e=>{i(e),a([])}).finally(()=>{c(!1)})},[e]),[t,l,f]}function h(e,t,a,l){var i=s(),[f,c]=n(null),[h,d]=n(null),[m,S]=n(!0);return o(()=>{u("START",{bookingSessionId:e,selectedRoomKey:t.key,selectedPartnerName:a.name,locationId:a.hotel.locationId,transactionId:r(),trackingContext:l}).then(e=>{c(e),d(null)}).catch(e=>{d(e),c(null)}).finally(()=>{S(!1)})},[e,t,a,l,i]),[f,h,m]}function d(){var e=s(),[t,r]=n(null),[a,l]=n(null),[i,f]=n(!0);return o(()=>{u("SENSITIVE").then(e=>{r({email:e.email||"",firstName:e.firstName||"",lastName:e.lastName||"",phoneNumbers:e.phoneNumbers,streetAddresses:e.streetAddresses}),l(null)}).catch(e=>{l(e),r(null)}).finally(()=>{f(!1)})},[e]),[t,a,i]}var m=e=>parseInt(e.replace(/[^0-9]/g,""),10),S=(e,t,r)=>{if(r){var n=t-e;return n>=-10&&n<=3}return t===e},p=(e,t)=>{var{originalMetaPrice:r}=t;return a(()=>{var t=e?.[0]?.rooms.some(e=>!!e.cashbackReward)||!1,n=e?.[0]?.rooms.map(e=>m(e.displayPrice));return n?.some(e=>S(r,e,t))?"same":n?.some(e=>e<r)?"lower":"higher"},[e,r])};return e({attemptBooking:f,useSensitiveFlowState:d,useStartFlowState:h,useStoredCardsFlowState:c}),[()=>{e({attemptBooking:f,usePriceMismatchCheck:p,useSensitiveFlowState:d,useStartFlowState:h,useStoredCardsFlowState:c})},[e=>r=e.uuid,e=>(n=e.useState,o=e.useEffect,a=e.useMemo),e=>s=e.useUserId]]},["eww825","o4yt4q","52far5"]]);
